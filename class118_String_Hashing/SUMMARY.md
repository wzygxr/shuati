# 字符串哈希专题总结

## 核心思想与原理

字符串哈希是一种将字符串映射为整数的技术，通过将字符串转换为哈希值，可以在O(1)时间内比较两个字符串是否相等。这是处理字符串相关问题的一种重要技巧。

### 哈希函数设计

常用的多项式哈希函数：
```
hash(s) = (s[0] * base^(n-1) + s[1] * base^(n-2) + ... + s[n-1] * base^0) mod MOD
```

其中：
- base通常选择一个质数（如131, 13331, 499等）
- MOD通常选择一个大质数（如1000000007, 1000000009等）

### 滚动哈希技术

滚动哈希是一种高效的计算子串哈希值的技术，特别适用于需要计算大量子串哈希值的场景。

对于子串s[l..r]的哈希值计算：
```
hash(s[l..r]) = (hash[r] - hash[l-1] * base^(r-l+1)) mod MOD
```

其中hash[i]表示前缀s[0..i-1]的哈希值。

## 应用场景与题型分析

### 1. 字符串去重问题
**典型题目**: 洛谷 P3370、牛客网字符串哈希题
**核心思路**: 将每个字符串映射为一个哈希值，使用HashSet统计不同哈希值的个数
**时间复杂度**: O(N*M)，其中N是字符串个数，M是字符串平均长度

### 2. 子串统计问题
**典型题目**: POJ 1200 Crazy Search
**核心思路**: 使用滚动哈希技术计算所有长度为N的子串的哈希值，统计不同哈希值的个数
**时间复杂度**: O(M*N)，其中M是字符串长度

### 3. 字符串匹配问题
**典型题目**: SPOJ NAJPF Pattern Find
**核心思路**: 计算模式串的哈希值，在文本中查找匹配的哈希值
**时间复杂度**: O(n+m)，其中n是文本长度，m是模式串长度

### 4. 回文串问题
**典型题目**: CodeForces 835D Palindromic characteristics
**核心思路**: 结合字符串哈希和动态规划，通过前缀哈希和后缀哈希判断回文性
**时间复杂度**: O(n^2)

### 5. 最长重复子串问题
**典型题目**: Code08_LongestDuplicateSubstring
**核心思路**: 使用二分搜索+字符串哈希，二分答案长度，用哈希验证是否存在重复子串
**时间复杂度**: O(n*log(n))

### 6. Rabin-Karp算法应用
**典型题目**: Code14_RabinKarpAlgorithm
**核心思路**: 经典字符串匹配算法，使用滚动哈希技术实现高效模式匹配
**时间复杂度**: 平均O(n+m)，最坏O(n*m)

### 7. 多模式字符串匹配
**典型题目**: Code15_StringHashApplications, Code16_AdvancedStringHash
**核心思路**: 扩展Rabin-Karp算法支持多模式匹配，使用哈希表存储模式串信息
**时间复杂度**: O(n + m1 + m2 + ... + mk)

### 8. 回文对问题
**典型题目**: Code16_AdvancedStringHash中的回文对问题
**核心思路**: 结合字符串哈希和回文检测技术，高效解决复杂回文问题
**时间复杂度**: O(n*k^2)

### 9. 循环字符串处理
**典型题目**: Code16_AdvancedStringHash中的循环同构检测
**核心思路**: 将字符串复制拼接后使用哈希技术检测循环同构
**时间复杂度**: O(n)

## 技巧与优化

### 1. 双哈希技术
为了减少哈希冲突的概率，可以同时使用两个不同的哈希函数，只有当两个哈希值都相等时才认为字符串相等。

### 2. 预处理优化
预先计算幂次数组和前缀哈希数组，可以在O(1)时间内计算任意子串的哈希值。

### 3. 模运算优化
在实际实现中，要注意模运算的正确性，避免负数取模的问题。

### 4. 基数选择
选择合适的基数可以减少哈希冲突，常用的基数有131、13331、499等。

## 边界场景与异常处理

### 1. 空字符串处理
需要特别处理空字符串的情况，避免数组越界。

### 2. 极端输入
对于超长字符串或大量字符串的情况，要注意内存使用和时间复杂度。

### 3. 字符集处理
不同的字符集（ASCII、Unicode等）需要不同的映射方式。

### 4. 哈希冲突
虽然概率很小，但仍需考虑哈希冲突的情况，可以使用双哈希或多哈希来降低冲突概率。

## 工程化考量

### 1. 异常抛出
明确非法输入的处理方式，如空指针、负数长度等。

### 2. 单元测试
编写全面的测试用例，包括边界情况、极端输入、特殊字符等。

### 3. 性能优化
针对大规模数据，优化算法实现，减少不必要的计算。

### 4. 可配置性
设计可配置的参数，如基数、模数等，方便根据不同场景调整。

## 面试与笔试要点

### 1. 拆解题干核心需求
- 提取输入输出约束
- 明确目标任务
- 识别关键算法点

### 2. 代码效率优化
- 时间优化：避免冗余循环、减少重复计算
- 空间优化：能原地就不额外开空间

### 3. 多解法对比与最优解选择
- 分析不同解法的时间复杂度和空间复杂度
- 根据题目约束选择最适合的解法

### 4. 调试能力
- 打印中间过程定位错误
- 用断言验证中间结果
- 性能退化的排查方法

## 数学原理与扩展应用

### 1. 与机器学习的联系
字符串哈希在特征工程中常用于文本特征的快速计算和比较。

### 2. 与自然语言处理的联系
在NLP中，字符串哈希可用于快速匹配词汇、计算相似度等。

### 3. 反直觉设计
- 哈希冲突虽然理论上可能发生，但在实际应用中概率极低
- 模运算虽然增加了计算复杂度，但能有效避免整数溢出

## 语言特性差异

### 1. Java
- 内置HashSet和HashMap，使用方便
- 自动内存管理，无需手动释放内存

### 2. C++
- 需要手动实现哈希表或使用STL（但要符合项目要求）
- 需要注意内存管理和指针操作

### 3. Python
- 内置set和dict，使用简单
- 动态类型，编写代码更简洁

## 总结

字符串哈希是一种非常实用的算法技巧，在处理字符串相关问题时能显著提高效率。掌握其核心原理和应用场景，对于算法竞赛和实际开发都有很大帮助。在使用时要注意哈希冲突的处理、边界情况的处理以及性能优化等问题。