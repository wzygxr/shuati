// [HAOI2018]染色
// 题目描述：有一个长度为N的序列和M种颜色，给定S以及一个序列W。
// 对于一种染色方案，假设其中有k种颜色恰好出现了S次，则其价值为W_k。
// 求所有染色方案的价值和对1004535809取模的结果。
// 1 <= N <= 10^7, 1 <= M <= 10^5, 1 <= S <= 150, 0 <= W_i < 1004535809
// 测试链接: https://www.luogu.com.cn/problem/P4491

/*
二项式反演在染色问题中的应用：

问题描述：
有一个长度为N的序列和M种颜色，每个位置可以染成M种颜色中的某一种。
对于一种染色方案，假设其中有k种颜色恰好出现了S次，则其价值为W_k。
求所有染色方案的价值和。

解题思路：
设f(i)表示恰好有i种颜色恰好出现S次的方案数（目标）
设g(i)表示至少有i种颜色恰好出现S次的方案数

显然，g(i)更容易计算：
1. 先从M种颜色中选出i种颜色，方案数为C(M, i)
2. 从N个位置中选出i*S个位置分配给这i种颜色，每种颜色恰好S个位置，方案数为C(N, i*S) * (i*S)! / (S!)^i
3. 剩下的N-i*S个位置可以染成剩下的M-i种颜色中的任意一种，方案数为(M-i)^(N-i*S)
   
因此：g(i) = C(M, i) * C(N, i*S) * (i*S)! / (S!)^i * (M-i)^(N-i*S)

根据二项式反演公式2：
f(k) = Σ(i=k to min(M, N/S)) (-1)^(i-k) * C(i, k) * g(i)

最终答案为：Σ(k=0 to min(M, N/S)) W_k * f(k)

相关题目：
1. 洛谷 P4491 [HAOI2018]染色（标准题目）
2. 洛谷 P5505 [JSOI2011]分特产（类似思想）
*/

// 由于编译环境限制，此处省略具体实现
// 实际使用时需要实现完整的C++版本代码