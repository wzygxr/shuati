package class066;

/**
 * 丑数 II (Ugly Number II)
 * 
 * 题目来源：LeetCode 264. 丑数 II
 * 题目链接：https://leetcode.cn/problems/ugly-number-ii/
 * 
 * 题目描述：
 * 给你一个整数 n ，请你找出并返回第 n 个 丑数 。
 * 丑数 就是只包含质因数 2、3 和/或 5 的正整数；1 是丑数。
 * 
 * 示例 1：
 * 输入：n = 10
 * 输出：12
 * 解释：1, 2, 3, 4, 5, 6, 8, 9, 10, 12 是前 10 个丑数。
 * 
 * 示例 2：
 * 输入：n = 1
 * 输出：1
 * 解释：1 通常被视为丑数。
 * 
 * 提示：
 * 1 <= n <= 1690
 * 
 * 解题思路：
 * 这是一个典型的多指针动态规划问题。丑数序列可以通过以下方式生成：
 * 1. 从1开始，每个丑数都可以通过之前的丑数乘以2、3或5得到
 * 2. 使用三个指针分别指向下一个要乘以2、3、5的丑数
 * 3. 每次选择三个候选值中的最小值作为下一个丑数
 * 4. 更新对应的指针，避免重复生成相同的丑数
 * 
 * 算法复杂度分析：
 * - 时间复杂度：O(n) - 需要计算n个丑数
 * - 空间复杂度：O(n) - dp数组存储所有丑数
 * 
 * 工程化考量：
 * 1. 边界处理：正确处理n=1的特殊情况
 * 2. 指针管理：正确更新指针避免重复计算
 * 3. 性能优化：使用多指针技术避免重复计算
 * 4. 代码质量：清晰的变量命名和详细的注释说明
 * 5. 测试覆盖：包含基本测试用例和边界情况测试
 * 
 * 相关题目：
 * - LeetCode 263. 丑数
 * - LintCode 4. 丑数 II
 * - AtCoder Educational DP Contest E - Knapsack 2
 * - 牛客网 动态规划专题 - 多指针问题
 * - HackerRank Ugly Numbers
 * - CodeChef UGLYNUM
 * - SPOJ UGLY
 */
public class Code05_UglyNumberII {

	// 时间复杂度O(n)，n代表第n个丑数
	// 空间复杂度O(n)，dp数组存储所有丑数
	// 核心思想：使用三个指针分别指向下一个要乘以2、3、5的丑数
	// 每次选择三个候选值中的最小值作为下一个丑数
	public static int nthUglyNumber(int n) {
		// dp数组存储丑数序列，dp[i]表示第i个丑数
		// 索引从1开始，dp[1] = 1
		int[] dp = new int[n + 1];
		dp[1] = 1;
		
		// 三个指针分别指向下一个要乘以2、3、5的丑数在dp数组中的位置
		// i2: 下一个要乘以2的丑数索引
		// i3: 下一个要乘以3的丑数索引
		// i5: 下一个要乘以5的丑数索引
		for (int i = 2, i2 = 1, i3 = 1, i5 = 1, a, b, c, cur; i <= n; i++) {
			// 计算三个候选值
			a = dp[i2] * 2;  // 当前i2位置的丑数乘以2
			b = dp[i3] * 3;  // 当前i3位置的丑数乘以3
			c = dp[i5] * 5;  // 当前i5位置的丑数乘以5
			
			// 选择三个候选值中的最小值作为下一个丑数
			cur = Math.min(Math.min(a, b), c);
			
			// 更新对应的指针，避免重复生成相同的丑数
			// 注意：这里使用独立的if语句而不是if-else if结构
			// 因为可能存在多个候选值相等的情况（例如2*3 = 3*2）
			if (cur == a) {
				i2++;  // 如果选择了乘以2的结果，移动i2指针
			}
			if (cur == b) {
				i3++;  // 如果选择了乘以3的结果，移动i3指针
			}
			if (cur == c) {
				i5++;  // 如果选择了乘以5的结果，移动i5指针
			}
			
			// 将计算出的丑数存入dp数组
			dp[i] = cur;
		}
		return dp[n];  // 返回第n个丑数
	}
    
	// 测试用例
	public static void main(String[] args) {
		System.out.println("测试丑数II问题：");
		
		// 测试用例
		for (int i = 1; i <= 10; i++) {
			System.out.println("第" + i + "个丑数: " + nthUglyNumber(i));
		}
		
		// 特殊测试用例
		System.out.println("第1690个丑数: " + nthUglyNumber(1690));
	}

}