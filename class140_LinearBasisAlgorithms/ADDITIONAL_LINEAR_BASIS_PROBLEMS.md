# 线性基算法补充题目

本文档收录了更多与线性基数据结构相关的经典算法题目，提供详细的题目描述、来源和解题思路。

## 洛谷题目

### 1. P3812 【模板】线性基
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P3812
- **题目描述**：给定n个整数（数字可能重复），求在这些数中选取任意个，使得他们的异或和最大。
- **解题思路**：线性基模板题，直接构建线性基并贪心选择元素来最大化异或和。

### 2. P3265 [JLOI2015]装备购买
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P3265
- **题目描述**：有n个物品，每个物品有m个属性值和一个价格。如果已选择的物品可以通过线性组合得到当前物品，则当前物品是不必要的。求在不出现不必要物品的前提下，最多能购买多少物品且花费最少。
- **解题思路**：将物品的属性值看作向量，使用线性基判断线性相关性，贪心选择价格较低的物品。

### 3. P4570 [BJWC2011]元素
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P4570
- **题目描述**：有n种矿石，每种矿石有一个元素序号和魔力值。如果选择的矿石元素序号异或和为0，则会发生魔法抵消。求在不发生魔法抵消的前提下，能获得的最大魔力值。
- **解题思路**：按魔力值从大到小排序，使用线性基判断是否线性相关，贪心选择矿石。

### 4. P4301 [CQOI2013]新Nim游戏
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P4301
- **题目描述**：在第一个回合中，双方可以直接拿走若干个整堆的火柴。从第二个回合开始，规则和Nim游戏一样。如果你先拿，怎样才能保证获胜？如果可以获胜的话，还要让第一回合拿的火柴总数尽量小。
- **解题思路**：要保证获胜，第一回合结束后剩余火柴堆的异或和不能为0。这等价于选出一些火柴堆，使得剩下的火柴堆线性相关。按火柴数量从大到小排序，贪心构建线性基。

### 5. P4151 [WC2011]最大XOR和路径
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P4151
- **题目描述**：给定一个边权为非负整数的无向连通图，求一条从1号节点到N号节点的路径，使得路径上经过的边的权值的XOR和最大。
- **解题思路**：任意一条从1到N的路径都可以表示为一条固定路径加上若干个环的异或和。使用DFS找环构建线性基，然后贪心选择元素来最大化异或和。

### 6. P3292 [SCOI2016]幸运数字
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P3292
- **题目描述**：给定一棵树，每个节点有一个幸运数字。多次询问两点间路径上节点幸运数字异或和的最大值。
- **解题思路**：树上倍增+线性基。预处理每个节点到祖先节点路径上的线性基，查询时合并路径上的线性基。

### 7. P4839 P哥的桶
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P4839
- **题目描述**：有n个桶排成一排，支持向桶中添加数字和查询区间桶中数字能异或出的最大值。
- **解题思路**：线段树维护线性基。每个节点维护对应区间数字构成的线性基，查询时合并区间线性基。

### 8. P5607 [Ynoi2013]无力回天NOI2017
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P5607
- **题目描述**：维护m个集合，支持向集合中插入元素和查询两个集合并的元素个数。
- **解题思路**：线段树分治+线性基。将操作看作时间轴上的区间，用线段树分治处理。

### 9. P4869 albus就是要第一个出场
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P4869
- **题目描述**：给定一个数组，求所有子集异或和排序后，给定值第一次出现的位置。
- **解题思路**：线性基+组合数学。计算线性基的大小，通过组合数学计算每个异或值出现的次数。

### 10. P5556 圣剑护符
- **题目来源**：洛谷
- **题目链接**：https://www.luogu.com.cn/problem/P5556
- **题目描述**：给定一棵树，每个节点有一个属性值。支持查询树上路径异或和是否能选出两个不相等的子集使其异或和相等，以及修改路径上节点的属性值。
- **解题思路**：树链剖分+线性基。维护路径上线性基，判断是否存在线性相关的子集。

## Codeforces题目

### 1. CF895C Square Subsets
- **题目来源**：Codeforces
- **题目链接**：https://www.luogu.com.cn/problem/CF895C
- **题目描述**：给定一个数组，求有多少种不同的方法选择非空子集，使得所选元素的乘积等于某个整数的平方。
- **解题思路**：质因数分解+线性基。将每个数分解质因数，保留次数为奇数的质因数，用线性基计算方案数。

### 2. CF1100F Ivan and Burgers
- **题目来源**：Codeforces
- **题目链接**：https://www.luogu.com.cn/problem/CF1100F
- **题目描述**：给定一个数组，多次询问区间内选取若干个数能得到的最大异或和。
- **解题思路**：前缀线性基。预处理前缀线性基，查询时通过前缀线性基计算区间线性基。

### 3. CF959F Mahmoud and Ehab and yet another xor task
- **题目来源**：Codeforces
- **题目链接**：https://www.luogu.com.cn/problem/CF959F
- **题目描述**：给定一个数组，多次询问前缀内有多少个子序列的异或和等于给定值。
- **解题思路**：线性基+动态规划。维护前缀线性基，通过线性基大小计算方案数。

### 4. CF724G Xor-matic Number of the Graph
- **题目来源**：Codeforces
- **题目链接**：https://www.luogu.com.cn/problem/CF724G
- **题目描述**：给定一个无向图，求所有满足条件的三元组(u,v,s)中s的和，其中s是u到v路径上边权异或和。
- **解题思路**：DFS找环+线性基。找到图中所有环的异或和，构建线性基计算贡献。

### 5. CF845G Shortest Path Problem?
- **题目来源**：Codeforces
- **题目链接**：https://www.luogu.com.cn/problem/CF845G
- **题目描述**：给定一个带权无向图，求从顶点1到顶点n的最短路径长度，路径长度定义为路径上所有边权的按位异或。
- **解题思路**：DFS找环+线性基。任意一条从1到n的路径都可以表示为一条固定路径加上若干个环的异或和。

### 6. CF1163E Magical Permutation
- **题目来源**：Codeforces
- **题目链接**：https://www.luogu.com.cn/problem/CF1163E
- **题目描述**：给定一个集合S，构造一个0到2^x-1的排列，使得相邻元素的异或值属于集合S，求最大的x。
- **解题思路**：线性基构造。构建线性基，通过线性基构造满足条件的排列。

## LeetCode题目

### 1. LeetCode 421. 数组中两个数的最大异或值
- **题目来源**：LeetCode
- **题目链接**：https://leetcode.com/problems/maximum-xor-of-two-numbers-in-an-array/
- **题目描述**：给定一个非空数组，返回数组中两个数的最大异或值。
- **解题思路**：字典树+线性基。将每个数的二进制表示插入字典树，贪心选择能产生最大异或值的路径。

### 2. LeetCode 1707. 与数组中元素的最大异或值
- **题目来源**：LeetCode
- **题目链接**：https://leetcode.com/problems/maximum-xor-with-an-element-from-array/
- **题目描述**：给定一个数组和多个查询，每个查询包含xi和mi，求xi与数组中不超过mi的元素的最大异或值。
- **解题思路**：离线处理+字典树。将查询按mi排序，离线处理，动态维护字典树。

## HDU题目

### 1. HDU 3949 XOR
- **题目来源**：HDU
- **题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=3949
- **题目描述**：给定一个数组，求所有子集异或和中第k小的值。
- **解题思路**：线性基+高斯消元。构建对角化线性基，通过k的二进制表示查询第k小值。

## 解题技巧总结

### 1. 线性基构建
- 从高位到低位扫描，贪心地选择能增加线性基维度的元素
- 时间复杂度：O(n * log W)，其中W是值域大小

### 2. 最大异或和查询
- 构建线性基后，从高位到低位贪心选择能使异或和增大的元素
- 时间复杂度：O(log W)

### 3. 第k小异或和查询
- 需要构建对角化线性基（高斯消元法）
- 通过k的二进制表示查询第k小值

### 4. 线性相关性判断
- 尝试将元素插入线性基，如果不能插入说明线性相关

### 5. 区间查询处理
- 前缀线性基：预处理前缀线性基，查询时通过差分计算区间线性基
- 线段树维护线性基：每个节点维护对应区间的线性基

### 6. 图论问题处理
- DFS找环：通过DFS找到图中所有环的异或和
- 树上问题：树链剖分、树上倍增等结合线性基

## 时间复杂度分析

- 线性基插入：O(log W)
- 线性基查询最大异或和：O(log W)
- 线性基查询第k小异或和：O(log²W)
- 前缀线性基预处理：O(n * log W)
- 线段树维护线性基：O(n * log n * log W)

## 空间复杂度分析

- 线性基：O(log W)
- 前缀线性基：O(n * log W)
- 线段树维护线性基：O(n * log n * log W)