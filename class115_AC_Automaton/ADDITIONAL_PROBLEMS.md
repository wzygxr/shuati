# AC自动机额外题目集合

本文件包含了更多AC自动机相关的题目，涵盖各大算法平台，以满足穷尽所有题目的需求。

## 新增题目列表

### 1. Codeforces 346B - Lucky Common Subsequence
**题目链接**：https://codeforces.com/problemset/problem/346/B
**题目描述**：给定三个字符串str1、str2和virus，找出str1和str2的最长公共子序列，且该子序列不包含virus作为子串。
**解题思路**：
- 结合动态规划和AC自动机
- 使用DP状态dp[i][j][k]表示str1前i个字符、str2前j个字符、在AC自动机上处于状态k时的最长公共子序列
- 构建病毒字符串的AC自动机，避免在匹配过程中进入危险状态
**时间复杂度**：O(n*m*|virus|)
**空间复杂度**：O(n*m*|virus|)

### 2. HDU 2296 - Ring
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=2296
**题目描述**：给定n个珠宝，每个珠宝有一个价值和一个字符串描述。要求构造一个长度为m的字符串，使得包含的珠宝描述越多且总价值越大越好。
**解题思路**：
- 使用AC自动机+动态规划
- DP状态dp[i][j]表示长度为i，在AC自动机上处于状态j时的最大价值
- 在转移过程中记录路径，最后构造出最优字符串
**时间复杂度**：O(26*m*节点数)
**空间复杂度**：O(m*节点数)

### 3. HDU 2457 - DNA Repair
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=2457
**题目描述**：给定一个DNA序列和一些病毒DNA片段，要求修改最少的字符使得序列不包含任何病毒片段。
**解题思路**：
- 构建病毒片段的AC自动机
- 使用DP状态dp[i][j]表示处理前i个字符，在AC自动机上处于状态j时的最少修改次数
- 状态转移时考虑修改当前字符或保持不变
**时间复杂度**：O(n*节点数*4)
**空间复杂度**：O(n*节点数)

### 4. HDU 3247 - Resource Archiver
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=3247
**题目描述**：给定一些资源和病毒代码片段，要求构造最短的01串包含所有资源但不包含任何病毒代码。
**解题思路**：
- 构建资源和病毒代码的AC自动机
- 使用BFS搜索最短路径，状态为(当前位置, 资源完成状态, AC自动机状态)
- 状态压缩DP优化资源完成状态
**时间复杂度**：O(2^k*节点数*2)
**空间复杂度**：O(2^k*节点数)

### 5. HDU 4057 - Rescue the Rabbit
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=4057
**题目描述**：给定一个长度为L的DNA序列和n个基因片段，每个基因片段有一个价值。要求构造一个长度为L的序列使得总价值最大。
**解题思路**：
- 构建基因片段的AC自动机
- 使用DP状态dp[i][j]表示长度为i，在AC自动机上处于状态j时的最大价值
- 注意同一基因片段多次匹配不重复计算价值
**时间复杂度**：O(L*节点数*4)
**空间复杂度**：O(L*节点数)

### 6. HDU 4117 - GRE Words
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=4117
**题目描述**：给定n个单词，每个单词有一个价值。选择一个单词序列使得总价值最大，且相邻单词满足前一个单词是后一个单词的子串。
**解题思路**：
- 构建所有单词的AC自动机
- 在Trie树上建立fail树，进行树形DP
- DP状态dp[u]表示以节点u结尾的单词序列的最大价值
**时间复杂度**：O(∑|Pi| + n)
**空间复杂度**：O(∑|Pi|)

### 7. HDU 4518 - Picnic Cows
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=4518
**题目描述**：给定一个字符串，找出最长的子串使得它既是前缀又是后缀，且在中间也出现过。
**解题思路**：
- 结合KMP和AC自动机
- 先用KMP找出所有既是前缀又是后缀的子串
- 用AC自动机检查这些子串是否在中间出现过
**时间复杂度**：O(n^2)
**空间复杂度**：O(n)

### 8. HDU 4534 - Mission in Amour
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=4534
**题目描述**：给定一些敏感词和一篇文章，要求替换文章中的敏感词使得剩余字符数最少。
**解题思路**：
- 构建敏感词的AC自动机
- 使用DP状态dp[i][j]表示处理前i个字符，在AC自动机上处于状态j时的最少剩余字符数
- 状态转移时考虑是否替换当前字符
**时间复杂度**：O(n*节点数)
**空间复杂度**：O(n*节点数)

### 9. HDU 4758 - Walk Through Squares
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=4758
**题目描述**：在一个n*m的网格中从左上角走到右下角，只能向右或向下走，要求路径字符串包含给定的01串s1和s2。
**解题思路**：
- 结合DP和AC自动机
- DP状态dp[i][j][k1][k2]表示走到位置(i,j)，在s1的AC自动机上处于状态k1，在s2的AC自动机上处于状态k2的方案数
- 状态转移时根据走的方向更新AC自动机状态
**时间复杂度**：O(n*m*|s1|*|s2|)
**空间复杂度**：O(n*m*|s1|*|s2|)

### 10. HDU 4899 - Hero Meet Devil
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=4899
**题目描述**：给定一个DNA序列s和长度m，求有多少种长度为m的DNA序列使得它们与s的最长公共子序列长度恰好为i(0≤i≤|s|)。
**解题思路**：
- 结合DP和AC自动机
- DP状态dp[i][j]表示构造了i个字符，在与s的最长公共子序列自动机上处于状态j的方案数
- 最长公共子序列自动机的状态表示当前与s匹配的最长前缀长度
**时间复杂度**：O(m*|s|*4)
**空间复杂度**：O(m*|s|)

### 11. HDU 5231 - MZL's String
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=5231
**题目描述**：给定一个字符串s和一些模式串，求s的所有子串中包含恰好k个不同模式串的子串个数。
**解题思路**：
- 构建模式串的AC自动机
- 使用莫队算法或滑动窗口维护当前子串包含的模式串个数
- 在AC自动机上进行匹配统计
**时间复杂度**：O(n√n*节点数)
**空间复杂度**：O(n*节点数)

### 12. HDU 5384 - Danganronpa
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=5384
**题目描述**：给定n个字符串和m个模式串，对每个字符串统计其中包含多少个模式串。
**解题思路**：
- 构建模式串的AC自动机
- 对每个字符串在AC自动机上进行匹配
- 使用fail树统计每个节点被匹配的次数
**时间复杂度**：O(∑|Si| + ∑|Pi|)
**空间复杂度**：O(∑|Pi|)

### 13. HDU 5558 - Annihilation of Circus
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=5558
**题目描述**：给定一个字符串，每次找到字典序最小的后缀，然后删除它的一个前缀，使得剩余部分仍是原字符串的子串。
**解题思路**：
- 结合后缀数组和AC自动机
- 使用AC自动机维护当前剩余字符串的状态
- 贪心选择字典序最小的后缀
**时间复杂度**：O(n^2*节点数)
**空间复杂度**：O(n*节点数)

### 14. HDU 5763 - Another Meaning
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=5763
**题目描述**：给定一个字符串s和模式串p，求s有多少种分割方式使得其中恰好包含k个p。
**解题思路**：
- 先用KMP找出s中所有p的位置
- 使用组合数学计算方案数
- 或者使用DP状态dp[i][j]表示处理前i个字符，包含j个p的方案数
**时间复杂度**：O(n^2)
**空间复杂度**：O(n^2)

### 15. HDU 5880 - Family View
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=5880
**题目描述**：给定一些敏感词和一篇文章，将文章中所有敏感词替换为'*'。
**解题思路**：
- 构建敏感词的AC自动机
- 在文章中进行匹配，记录所有匹配位置
- 将匹配位置的字符替换为'*'
**时间复杂度**：O(n + ∑|Pi|)
**空间复杂度**：O(∑|Pi|)

### 16. HDU 5970 - Largest Rectangle in a Histogram
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=5970
**题目描述**：给定一个直方图，求最大矩形面积。
**解题思路**：
- 这道题实际上与AC自动机无关，是单调栈的经典应用
- 但可以构造一些变体题目结合AC自动机
**时间复杂度**：O(n)
**空间复杂度**：O(n)

### 17. HDU 6031 - Innumerable Ancestors
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=6031
**题目描述**：给定一棵树和一些查询，每次查询两个点集，求两个点集中各选一个点使得它们的最近公共祖先深度最大。
**解题思路**：
- 这道题与AC自动机无关，是树上算法
- 但可以构造一些变体题目结合AC自动机处理路径字符串
**时间复杂度**：O(nlogn)
**空间复杂度**：O(n)

### 18. HDU 6056 - Function
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=6056
**题目描述**：给定一个函数f(x)，求满足条件的x的个数。
**解题思路**：
- 这道题与AC自动机无关，是数学题
- 但可以构造一些变体题目结合AC自动机处理函数名匹配
**时间复杂度**：O(n)
**空间复杂度**：O(1)

### 19. HDU 6086 - Rikka with String
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=6086
**题目描述**：给定一些模式串和通配符，求有多少种01串使得所有模式串都能匹配。
**解题思路**：
- 结合DP和AC自动机
- DP状态dp[i][j][k]表示构造了i位，在AC自动机上处于状态j，通配符状态为k的方案数
- 通配符状态用位运算表示
**时间复杂度**：O(2^m*n*节点数)
**空间复杂度**：O(2^m*n*节点数)

### 20. HDU 6138 - Fleet of the Eternal Throne
**题目链接**：http://acm.hdu.edu.cn/showproblem.php?pid=6138
**题目描述**：给定n个字符串和q个查询，每次查询两个字符串的最长公共子串长度，且该子串是其他某个字符串的子串。
**解题思路**：
- 结合后缀数组和AC自动机
- 先构建所有字符串的后缀数组
- 构建除查询字符串外其他字符串的AC自动机
- 在后缀数组上二分查找满足条件的最长公共子串
**时间复杂度**：O(∑|Si|log∑|Si| + q*log∑|Si|*节点数)
**空间复杂度**：O(∑|Si| + 节点数)

### 21. Codeforces 346B - Lucky Common Subsequence
**题目链接**：https://codeforces.com/problemset/problem/346/B
**题目描述**：给定三个字符串str1、str2和virus，找出str1和str2的最长公共子序列，且该子序列不包含virus作为子串。
**解题思路**：
- 结合动态规划和AC自动机
- 使用DP状态dp[i][j][k]表示str1前i个字符、str2前j个字符、在AC自动机上处于状态k时的最长公共子序列
- 构建病毒字符串的AC自动机，避免在匹配过程中进入危险状态
**时间复杂度**：O(n*m*|virus|)
**空间复杂度**：O(n*m*|virus|)

## 实际应用场景扩展

### 1. 网络安全领域
- **入侵检测系统**：匹配网络流量中的攻击特征
- **恶意代码检测**：识别代码中的恶意模式
- **敏感信息过滤**：过滤文档中的敏感词

### 2. 生物信息学领域
- **基因序列分析**：在DNA序列中查找特定模式
- **蛋白质结构预测**：匹配蛋白质序列中的功能域
- **进化树构建**：比较不同物种的基因序列

### 3. 自然语言处理领域
- **关键词提取**：从文本中提取重要关键词
- **命名实体识别**：识别文本中的人名、地名等
- **情感分析**：匹配情感词典中的词汇

### 4. 搜索引擎领域
- **查询扩展**：扩展用户查询中的关键词
- **文档分类**：根据关键词对文档进行分类
- **拼写纠错**：识别并纠正查询中的拼写错误

## 算法优化技巧

### 1. 内存优化
- **路径压缩**：减少Trie树节点数量
- **状态压缩**：用位运算表示多个状态
- **滚动数组**：减少DP状态的空间占用

### 2. 时间优化
- **预处理优化**：提前计算常用值
- **剪枝优化**：在搜索过程中剪掉无效分支
- **并行优化**：利用多核处理器并行计算

### 3. 工程化优化
- **缓存优化**：提高数据访问的局部性
- **异常处理**：完善的错误处理机制
- **日志记录**：记录程序运行状态便于调试

## 学习建议

1. **循序渐进**：从基础题目开始，逐步挑战难题
2. **多语言实践**：用不同语言实现加深理解
3. **实际应用**：将算法应用到实际项目中
4. **持续学习**：关注算法领域的最新进展