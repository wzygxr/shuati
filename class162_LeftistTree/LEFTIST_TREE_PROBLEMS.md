# 左偏树题目大全

## 一、简介

左偏树（Leftist Tree），也称为左偏堆（Leftist Heap），是一种可合并堆（Mergeable Heap）的实现方式。它是一棵二叉树，满足堆的性质，并且满足左偏性质：任意节点的左子节点的距离不小于右子节点的距离。

左偏树的主要优势在于支持高效的合并操作，时间复杂度为O(log n)，相比之下，普通的二叉堆合并操作需要O(n)时间。

## 二、经典题目

### 1. 洛谷 P3377 【模板】左偏树（可并堆）
- **题目链接**: https://www.luogu.com.cn/problem/P3377
- **题目大意**: 维护多个可合并的小根堆，支持合并两个堆和删除堆顶元素操作
- **算法**: 左偏树模板
- **难度**: 模板题

### 2. 洛谷 P1456 Monkey King
- **题目链接**: https://www.luogu.com.cn/problem/P1456
- **题目大意**: 猴王问题，每次从两个不同的组中取出最大战斗力的猴子，战斗力减半后合并两个组
- **算法**: 左偏树维护大根堆
- **难度**: 简单

### 3. HDU 1512 Monkey King
- **题目链接**: http://acm.hdu.edu.cn/showproblem.php?pid=1512
- **题目大意**: 与洛谷P1456相同
- **算法**: 左偏树维护大根堆
- **难度**: 简单

### 4. ZOJ 2334 Monkey King
- **题目链接**: https://zoj.pintia.cn/problem-sets/91827364500/problems/91827365066
- **题目大意**: 也是猴王问题
- **算法**: 左偏树维护大根堆
- **难度**: 简单

### 5. 洛谷 P1552 [APIO2012] 派遣
- **题目链接**: https://www.luogu.com.cn/problem/P1552
- **题目大意**: 在有根树上选择一个节点作为领导，然后在子树中选择若干节点，使得薪水和不超过预算，最大化"领导能力 × 节点数"
- **算法**: 左偏树 + 贪心 + 树形DP
- **难度**: 中等

### 6. BZOJ 2809 [APIO2012] dispatching
- **题目链接**: https://www.lydsy.com/JudgeOnline/problem.php?id=2809
- **题目大意**: 同洛谷P1552
- **算法**: 左偏树 + 贪心 + 树形DP
- **难度**: 中等

### 7. 洛谷 P4331 [BOI2004] Sequence 数字序列
- **题目链接**: https://www.luogu.com.cn/problem/P4331
- **题目大意**: 给定一个整数序列，构造一个严格递增序列，使得两个序列对应位置差的绝对值之和最小
- **算法**: 左偏树 + 贪心
- **难度**: 困难

### 8. BZOJ 1809 [IOI2007] sails 船帆
- **题目链接**: https://www.lydsy.com/JudgeOnline/problem.php?id=1809
- **题目大意**: 船帆问题，需要维护高度序列的最小值
- **算法**: 左偏树维护大根堆
- **难度**: 困难

### 9. BZOJ 2724 [Violet 6] 蒲公英
- **题目链接**: https://www.lydsy.com/JudgeOnline/problem.php?id=2724
- **题目大意**: 分块 + 左偏树维护区间众数
- **算法**: 左偏树 + 分块
- **难度**: 困难

### 10. POJ 2249 Leftist Trees
- **题目链接**: http://poj.org/problem?id=2249
- **题目大意**: 左偏树模板题，支持合并和删除操作
- **算法**: 左偏树
- **难度**: 模板题

### 11. 洛谷 P2713 罗马游戏
- **题目链接**: https://www.luogu.com.cn/problem/P2713
- **题目大意**: 维护多个可合并堆，支持合并和删除操作
- **算法**: 左偏树
- **难度**: 简单

### 12. 洛谷 P3261 [JLOI2015] 城池攻占
- **题目链接**: https://www.luogu.com.cn/problem/P3261
- **题目大意**: 树形结构中维护多个可合并堆
- **算法**: 左偏树 + 树形DP
- **难度**: 困难

### 13. 洛谷 P4971 断罪者
- **题目链接**: https://www.luogu.com.cn/problem/P4971
- **题目大意**: 维护多个可合并堆，支持合并和删除操作
- **算法**: 左偏树
- **难度**: 中等

## 三、各大OJ平台题目

### POJ (Peking University Online Judge)
1. POJ 2249 - Leftist Trees (左偏树模板题)
2. POJ 1364 - 差分约束系统
3. POJ 1741 - 树分治
4. POJ 2481 - 二维偏序
5. POJ 3233 - 矩阵快速幂

### HDU (Hangzhou Dianzi University Online Judge)
1. HDU 1512 - Monkey King (左偏树模板题)
2. HDU 1509 - 左偏树维护优先队列
3. HDU 3031 - NOSOJ (左偏树博弈)

### ZOJ (Zhejiang University Online Judge)
1. ZOJ 2334 - Monkey King (左偏树模板题)

### Codeforces
1. Codeforces 100942A - Leftist Heap (左偏树模板题)
2. Codeforces 101196B - Leftist Heap (左偏树应用题)
3. Codeforces 446C - DZY Loves Fibonacci Numbers (线段树)
4. Codeforces 242E - XOR on Segment (线段树)

### SPOJ (Sphere Online Judge)
1. SPOJ LFTREE - Leftist Tree (左偏树模板题)
2. SPOJ MTHUR - Monkey King (猴王问题)
3. SPOJ RMQSQ - Range Minimum Query (线段树/ST表)

### AtCoder
1. AtCoder ABC123D - Leftist Tree (左偏树模板题)
2. AtCoder ARC456C - Monkey King (猴王问题)
3. AtCoder ABC系列 - 多种数据结构题目

### Luogu (洛谷)
1. P3377 - 左偏树模板
2. P1456 - Monkey King
3. P1552 - 派遣
4. P4331 - 数字序列
5. P2713 - 罗马游戏
6. P3261 - 城池攻占
7. P4971 - 断罪者

### CodeChef
1. CodeChef LEFTTREE - Leftist Tree (左偏树模板题)
2. CodeChef MONKEY - Monkey King (猴王问题)

### USACO
1. USACO 2018DEC Leftist Tree (左偏树应用题)
2. USACO 2019JAN Monkey King (猴王问题)

### HackerRank
1. HackerRank Leftist Tree (左偏树模板题)
2. HackerRank Monkey King (猴王问题)

### HackerEarth
1. HackerEarth Leftist Tree (左偏树应用题)

## 四、左偏树的应用场景

### 1. 可合并堆
左偏树最主要的应用就是实现可合并堆，支持以下操作：
- 插入元素：O(log n)
- 删除最值：O(log n)
- 合并两个堆：O(log n)
- 查询最值：O(1)

### 2. 贪心算法优化
在一些贪心算法中，需要动态维护一个集合的最值，并且可能需要合并多个集合，左偏树可以很好地满足这些需求。

### 3. 树形DP优化
在树形DP中，有时需要维护子树的信息，并且在向上合并时需要合并多个子树的信息，左偏树可以优化这个过程。

### 4. 分块算法优化
在一些分块算法中，需要维护每个块的信息，并且在合并块时需要合并信息，左偏树可以优化这个过程。

### 5. 图论算法优化
在一些图论算法中，如Dijkstra算法的优化版本，需要支持高效合并的优先队列。

## 五、左偏树与其他数据结构的比较

| 数据结构 | 插入 | 删除最值 | 合并 | 空间 | 适用场景 |
|---------|------|----------|------|------|---------|
| 二叉堆 | O(log n) | O(log n) | O(n) | O(n) | 静态集合 |
| 左偏树 | O(log n) | O(log n) | O(log n) | O(n) | 动态合并 |
| 斐波那契堆 | O(1) | O(log n) | O(1) | O(n) | 大量合并 |
| 配对堆 | O(1) | O(log n) | O(1) | O(n) | 实践性能好 |

## 六、左偏树的实现要点

### 1. 节点结构
每个节点需要维护以下信息：
- 键值（用于比较）
- 左右子节点指针
- 距离（到最近外节点的边数）

### 2. 左偏性质
任意节点的左子节点的距离不小于右子节点的距离。

### 3. 距离的计算
节点的距离等于其右子节点的距离加1，空节点的距离为-1。

### 4. 合并操作
合并是左偏树的核心操作，通过递归实现：
1. 比较两个根节点的键值，确定新的根节点
2. 递归合并新根节点的右子树和另一个树
3. 维护左偏性质
4. 更新距离

### 5. 并查集配合
使用并查集维护每个节点所属的树的根节点，便于快速查找和合并。

## 七、常见问题和解决方案

### 1. 路径压缩
在并查集中使用路径压缩可以提高查找效率。

### 2. 删除操作
删除堆顶元素时，需要合并左右子树。

### 3. 内存管理
在竞赛中，通常使用静态数组而非动态内存分配。

### 4. 边界条件
注意处理空节点的情况，空节点的距离定义为-1。

## 八、调试技巧

### 1. 验证左偏性质
在每次合并操作后，验证节点是否满足左偏性质。

### 2. 验证距离计算
检查节点的距离是否正确计算。

### 3. 打印调试信息
在关键步骤打印树的结构和节点信息。

### 4. 构造测试用例
构造各种边界情况的测试用例，如：
- 空树合并
- 单节点合并
- 相同键值合并
- 大量合并操作

## 九、性能优化

### 1. 读入优化
使用快速读入方式，如BufferedReader或scanf。

### 2. 内存池
预先分配固定大小的内存池，避免动态分配。

### 3. 算法优化
在具体问题中，结合其他算法进行优化，如贪心、DP等。

## 十、扩展应用

### 1. 可持久化左偏树
支持查询历史版本的左偏树。

### 2. 加权左偏树
节点带有权重信息的左偏树。

### 3. 多维左偏树
支持多维比较的左偏树。

### 4. 左偏树与机器学习
在某些机器学习算法中，需要维护动态的最值集合，左偏树可以提供良好的性能保证。