# 扩展欧几里得算法补充题目

## 一、经典题目汇总

### 1. 洛谷题目

#### (1) P1082 [NOIP2012 提高组] 同余方程
- **题目链接**: https://www.luogu.com.cn/problem/P1082
- **题目描述**: 求关于x的同余方程 ax ≡ 1 (mod b) 的最小正整数解
- **解题思路**: 使用扩展欧几里得算法求模逆元
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

#### (2) P1516 青蛙的约会
- **题目链接**: https://www.luogu.com.cn/problem/P1516
- **题目描述**: 两只青蛙在环形纬度线上跳跃，求它们何时相遇
- **解题思路**: 将问题转化为线性同余方程，使用扩展欧几里得算法求解
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

#### (3) P2054 [AHOI2005] 洗牌
- **题目链接**: https://www.luogu.com.cn/problem/P2054
- **题目描述**: 求n张牌洗m次之后第l张牌是什么
- **解题思路**: 结合快速幂和扩展欧几里得算法
- **时间复杂度**: O(log m)
- **空间复杂度**: O(1)

#### (4) P2421 [NOI2002]荒岛野人
- **题目链接**: https://www.luogu.com.cn/problem/P2421
- **题目描述**: 多个野人在环形山洞中移动，求最少山洞数使得它们在有生之年不会相遇
- **解题思路**: 对每对野人建立线性同余方程，使用扩展欧几里得算法判断是否会在有生之年相遇
- **时间复杂度**: O(MAX_C * n^2 * logC)
- **空间复杂度**: O(n)

#### (5) P2613 【模板】有理数取余
- **题目链接**: https://www.luogu.com.cn/problem/P2613
- **题目描述**: 计算有理数的模运算结果
- **解题思路**: 使用扩展欧几里得算法求模逆元
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

#### (6) P3811 【模板】乘法逆元
- **题目链接**: https://www.luogu.com.cn/problem/P3811
- **题目描述**: 求1到n所有整数在模p意义下的乘法逆元
- **解题思路**: 使用扩展欧几里得算法或线性递推
- **时间复杂度**: O(n log p) 或 O(n)
- **空间复杂度**: O(log p) 或 O(n)

#### (7) P4549 【模板】裴蜀定理
- **题目链接**: https://www.luogu.com.cn/problem/P4549
- **题目描述**: 给定长度为n的一组整数值，求线性组合能得到的最小正整数
- **解题思路**: 根据裴蜀定理，多个数的线性组合的最小正整数就是它们的最大公约数
- **时间复杂度**: O(n * log(min(ai)))
- **空间复杂度**: O(1)

#### (8) P5656 【模板】二元一次不定方程 (exgcd)
- **题目链接**: https://www.luogu.com.cn/problem/P5656
- **题目描述**: 求解二元一次不定方程 ax + by = c 的正整数解
- **解题思路**: 使用扩展欧几里得算法求特解，然后通过通解公式求所有解，并确定正整数解的范围
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(1)

### 2. POJ题目

#### (1) POJ 1061 青蛙的约会
- **题目链接**: http://poj.org/problem?id=1061
- **题目描述**: 两只青蛙在环形纬度线上跳跃，求它们何时相遇
- **解题思路**: 将问题转化为线性同余方程，使用扩展欧几里得算法求解
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

#### (2) POJ 1597 Uniform Generator
- **题目链接**: http://poj.org/problem?id=1597
- **题目描述**: 判断step和mod的组合是否能产生0~mod-1所有数字
- **解题思路**: 当gcd(step, mod) = 1时为"Good Choice"
- **时间复杂度**: O(log(min(step,mod)))
- **空间复杂度**: O(log(min(step,mod)))

#### (3) POJ 2115 C Looooops
- **题目链接**: http://poj.org/problem?id=2115
- **题目描述**: 模拟C语言for循环在k位无符号整数下的执行次数
- **解题思路**: 考虑整数回绕特性，将问题转化为线性同余方程求解
- **时间复杂度**: O(log(min(C,2^k)))
- **空间复杂度**: O(log(min(C,2^k)))

#### (4) POJ 2142 The Balance
- **题目链接**: http://poj.org/problem?id=2142
- **题目描述**: 用天平称重，求砝码数量最少的方案
- **解题思路**: 转化为ax + by = c的不定方程，使用扩展欧几里得算法求解
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

### 3. HDU题目

#### (1) HDU 1576 A/B
- **题目链接**: http://acm.hdu.edu.cn/showproblem.php?pid=1576
- **题目描述**: 计算 (A/B) mod 9973
- **解题思路**: 使用扩展欧几里得算法求B的模逆元
- **时间复杂度**: O(log(B))
- **空间复杂度**: O(log(B))

#### (2) HDU 2669 Romantic
- **题目链接**: http://acm.hdu.edu.cn/showproblem.php?pid=2669
- **题目描述**: 求解ax + by = 1的非负整数解
- **解题思路**: 使用扩展欧几里得算法求解，然后调整为非负整数解
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

#### (3) HDU 5512 Pagodas
- **题目链接**: http://acm.hdu.edu.cn/showproblem.php?pid=5512
- **题目描述**: 两个人轮流修塔，判断谁会赢
- **解题思路**: 根据数论知识，能修的塔的数量与gcd(a,b)有关
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

### 4. Codeforces题目

#### (1) Codeforces 1011E Border
- **题目链接**: https://codeforces.com/contest/1011/problem/E
- **题目描述**: 根据裴蜀定理求解可能到达的位置
- **解题思路**: 利用裴蜀定理确定线性组合能产生的所有值
- **时间复杂度**: O(n * log(max(a_i, m)))
- **空间复杂度**: O(1)

#### (2) Codeforces 1244C The Football Stage
- **题目链接**: https://codeforces.com/problemset/problem/1244/C
- **题目描述**: 求解线性丢番图方程wx + dy = p
- **解题思路**: 使用扩展欧几里得算法求解线性丢番图方程
- **时间复杂度**: O(log(min(w,d)))
- **空间复杂度**: O(log(min(w,d)))

#### (3) Codeforces 514B Han Solo and Lazer Gun
- **题目链接**: https://codeforces.com/problemset/problem/514/B
- **题目描述**: 用最少的光线消灭所有敌人
- **解题思路**: 使用最大公约数判断点是否在同一条直线上
- **时间复杂度**: O(n * log(min(dx,dy)))
- **空间复杂度**: O(n)

### 5. AtCoder题目

#### (1) AtCoder ACL Contest 1B Sum is Multiple
- **题目链接**: https://atcoder.jp/contests/acl1/tasks/acl1_b
- **题目描述**: 求最小k使得k(k+1)/2是n的倍数
- **解题思路**: 使用扩展欧几里得算法求解同余方程
- **时间复杂度**: O(log n)
- **空间复杂度**: O(log n)

#### (2) AtCoder ABC182E Throne
- **题目链接**: https://atcoder.jp/contests/abc182/tasks/abc182_e
- **题目描述**: 求到达特定位置的最小步数
- **解题思路**: 使用扩展欧几里得算法求解线性同余方程
- **时间复杂度**: O(log(min(n,s)))
- **空间复杂度**: O(log(min(n,s)))

### 6. LeetCode题目

#### (1) LeetCode 1250 检查「好数组」
- **题目链接**: https://leetcode.cn/problems/check-if-it-is-a-good-array/
- **题目描述**: 检查数组是否为好数组
- **解题思路**: 用到了裴蜀定理，如果数组中所有元素的最大公约数为1，则为好数组
- **时间复杂度**: O(n * log(max(nums)))
- **空间复杂度**: O(1)

#### (2) LeetCode 365 水壶问题
- **题目链接**: https://leetcode-cn.com/problems/water-and-jug-problem/
- **题目描述**: 给定两个水壶，容量分别为x和y，能否得到恰好z升的水？
- **解题思路**: 根据裴蜀定理，z必须是gcd(x,y)的倍数，且z不超过x+y
- **时间复杂度**: O(log(min(x,y)))
- **空间复杂度**: O(1)

### 7. 其他平台题目

#### (1) LightOJ 1077 How Many Points?
- **题目链接**: https://lightoj.com/problem/how-many-points
- **题目描述**: 求线段上的格点数量
- **解题思路**: 线段上的格点数量等于dx和dy的最大公约数加1
- **时间复杂度**: O(log(min(dx,dy)))
- **空间复杂度**: O(1)

#### (2) UVA 10088 Trees on My Island
- **题目链接**: https://onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=1029
- **题目描述**: 求多边形边界上的格点数量
- **解题思路**: 使用Pick定理计算，涉及最大公约数的应用
- **时间复杂度**: O(n * log(max(dx,dy)))
- **空间复杂度**: O(1)

#### (3) SPOJ CEQU
- **题目链接**: https://www.spoj.com/problems/CEQU/
- **题目描述**: 判断线性丢番图方程是否有解
- **解题思路**: 根据裴蜀定理，方程ax + by = c有整数解当且仅当gcd(a,b)能整除c
- **时间复杂度**: O(log(min(a,b)))
- **空间复杂度**: O(log(min(a,b)))

## 二、算法应用场景

### 1. 密码学应用
- **RSA算法中的密钥生成**: 计算模逆元得到私钥，利用扩展欧几里得算法求解 ed ≡ 1 (mod φ(n))
- **共模攻击**: 当多个消息使用相同模数但不同指数加密时的攻击方法，利用扩展欧几里得算法找到合适的系数

### 2. 编码理论应用
- **纠错码解码**: 在BCH码和RS码解码中求错误位置和错误值，利用扩展欧几里得算法求解关键方程

### 3. 计算机图形学应用
- **参数化曲线计算**: 在某些参数化曲线（如贝塞尔曲线）的计算中，扩展欧几里得算法可用于求解参数值

### 4. 信号处理应用
- **数字滤波器设计**: 在数字滤波器设计中，扩展欧几里得算法可用于计算滤波器系数

## 三、解题技巧总结

### 1. 方程转化技巧
- **线性同余方程**: ax ≡ b (mod m) ⟺ 不定方程 ax + my = b
- **模逆元**: ax ≡ 1 (mod m) ⟺ 不定方程 ax + my = 1
- **实际问题**: 实际问题 ⟶ 数学模型 ⟶ 标准方程

### 2. 解的处理技巧
- **特解 ⟶ 通解**: x = x₀ + (b/gcd(a,b))t, y = y₀ - (a/gcd(a,b))t
- **负数处理**: (x % m + m) % m 保证结果非负
- **正整数解范围**: 通过不等式组确定参数t的范围

### 3. 边界情况处理
- **a=0 或 b=0**: 的特殊情况
- **负数输入**: 的处理
- **无解情况**: 的判断和返回

### 4. 性能优化技巧
- **使用迭代版本**: 避免递归栈开销
- **预处理常用值**: 减少重复计算
- **大数运算**: 注意溢出处理

## 四、常见错误与注意事项

### 1. 数学建模错误
- **未能正确将实际问题转化为数学方程**
- **忽略了问题的约束条件**

### 2. 边界处理错误
- **未处理 a=0 或 b=0 的特殊情况**
- **负数模运算处理不当**
- **未正确判断无解情况**

### 3. 实现细节错误
- **递归版本栈溢出**
- **大数运算溢出**
- **输出格式不符合要求**

### 4. 性能优化不足
- **重复计算相同值**
- **未使用迭代版本导致效率低下**

## 五、学习建议

### 1. 理论基础
- **深入理解欧几里得算法和裴蜀定理**
- **掌握线性同余方程的求解方法**
- **学习相关数论知识**

### 2. 实践训练
- **从模板题开始，逐步提高难度**
- **多平台练习，拓宽视野**
- **总结常见题型和解题套路**

### 3. 进阶学习
- **学习中国剩余定理**
- **了解更高级的数论算法**
- **探索在实际项目中的应用**

### 4. 工程实践
- **注意代码的可读性和可维护性**
- **考虑异常处理和边界情况**
- **优化性能和内存使用**